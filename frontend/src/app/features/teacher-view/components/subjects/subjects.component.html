<div class="subject-container">
  <!-- Encabezado de la asignatura -->
  <div class="subject-header" *ngIf="subject">
    <h1>{{ subject.name }}</h1>
    <p class="subject-description">{{ subject.description }}</p>
  </div>
  
  <div class="subject-content">
    <!-- Panel izquierdo - Lista de estudiantes -->
    <div class="student-panel">
      <div class="panel-header">
        <h2>Estudiantes</h2>
        <div class="search-box">
          <input type="text" [(ngModel)]="searchTerm" placeholder="Buscar estudiante..." class="search-input">
          <span class="search-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
          </span>
        </div>
      </div>
      
      <div class="student-list">
        <div *ngIf="isLoadingStudents" class="loading-message">
          <p>Cargando estudiantes...</p>
        </div>
        
        <ng-container *ngIf="!isLoadingStudents">
          <div class="student-card" *ngFor="let student of getFilteredStudents()" 
            [routerLink]="['/teacher/student-profile']" 
            [queryParams]="{name: student.name}">
            <div class="student-avatar">
              {{ student.name.charAt(0) }}
            </div>
            <div class="student-info">
              <h3 class="student-name">{{ student.name }}</h3>
              <p class="student-email">{{ student.email }}</p>
            </div>
          </div>
          
          <div class="no-results" *ngIf="getFilteredStudents().length === 0">
            <p>No se encontraron estudiantes</p>
          </div>
        </ng-container>
      </div>
    </div>
    
    <!-- Panel central - Temas -->
    <div class="topics-panel">
      <div class="panel-header">
        <h2>Temas</h2>
        <button class="add-topic-btn" (click)="toggleNewTopicForm()">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Nuevo tema
        </button>
      </div>
      
      <!-- Formulario para nuevo tema -->
      <div class="new-topic-form" *ngIf="showNewTopicForm">
        <h3>Crear nuevo tema</h3>
        <div class="form-group">
          <label for="topicName">Nombre</label>
          <input type="text" id="topicName" [(ngModel)]="newTopicName" placeholder="Nombre del tema">
        </div>
        <div class="form-group">
          <label for="topicDescription">Descripción</label>
          <textarea id="topicDescription" [(ngModel)]="newTopicDescription" placeholder="Descripción del tema" rows="3"></textarea>
        </div>
        <div class="form-actions">
          <button class="cancel-btn" (click)="toggleNewTopicForm()">Cancelar</button>
          <button class="save-btn" (click)="addNewTopic()">Guardar</button>
        </div>
      </div>
      
      <!-- Lista de temas -->
      <div class="topics-list">
        <div 
          class="topic-card" 
          *ngFor="let topic of topics"
          [class.active]="selectedTopicId === topic.id"
          (click)="selectTopic(topic.id)"
        >
          <div class="topic-info">
            <h3 class="topic-name">{{ topic.name }}</h3>
            <p class="topic-description">{{ topic.description }}</p>
          </div>
          <div class="topic-stats">
            <span class="document-count">{{ topic.documentCount }} documentos</span>
          </div>
        </div>
        
        <div class="no-topics" *ngIf="topics.length === 0">
          <p>No hay temas disponibles</p>
        </div>
      </div>
    </div>
    
    <!-- Panel derecho - Documentos -->
    <div class="documents-panel">
      <div class="panel-header">
        <h2>Documentos</h2>
        <button 
          class="upload-btn" 
          [disabled]="!selectedTopicId"
          (click)="selectedTopicId && uploadDocument(selectedTopicId)"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="17 8 12 3 7 8"></polyline>
            <line x1="12" y1="3" x2="12" y2="15"></line>
          </svg>
          Subir documento
        </button>
      </div>
      
      <div class="documents-list" *ngIf="selectedTopicId">
        <div class="document-card" *ngFor="let doc of getFilteredDocumentsByTopic(selectedTopicId)">
          <div class="document-icon" [ngClass]="doc.type">
            <svg *ngIf="doc.type === 'pdf'" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            <svg *ngIf="doc.type === 'docx'" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
            </svg>
            <svg *ngIf="doc.type === 'ppt'" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
              <line x1="8" y1="21" x2="16" y2="21"></line>
              <line x1="12" y1="17" x2="12" y2="21"></line>
            </svg>
          </div>
          <div class="document-details">
            <div class="document-title">{{ doc.name }}</div>
            <div class="document-meta">
              <span>{{ doc.size }}</span>
              <span>{{ doc.uploadDate | date:'dd/MM/yyyy' }}</span>
            </div>
          </div>
          <div class="document-actions">
            <button class="action-btn download-btn">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
            </button>
          </div>
        </div>
        
        <div class="no-documents" *ngIf="getFilteredDocumentsByTopic(selectedTopicId).length === 0">
          <p>No hay documentos disponibles para este tema</p>
          <button class="upload-btn" (click)="uploadDocument(selectedTopicId)">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            Subir el primer documento
          </button>
        </div>
      </div>
      
      <div class="select-topic-message" *ngIf="!selectedTopicId">
        <p>Selecciona un tema para ver sus documentos</p>
      </div>
    </div>
  </div>
</div>
